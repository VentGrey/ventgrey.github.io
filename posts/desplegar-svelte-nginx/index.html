<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Desplegar Svelte en NGINX y no morir en el intento | La Esquina Gris</title><meta name=keywords content="Tutoriales,Svelte,NGINX,Linux"><meta name=description content="De nuevo, supongo que no encontrar√© respuestas diciendome que use Heroku, Vercel o esas weas...¬øverdad? :("><meta name=author content="VentGrey"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="Iyb36hxWrYaEXR1JJHRsc-E3vXidjcKH8hdE1pU5KxA"><link crossorigin=anonymous href=/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ventgrey.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ventgrey.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ventgrey.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ventgrey.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ventgrey.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Desplegar Svelte en NGINX y no morir en el intento"><meta property="og:description" content="De nuevo, supongo que no encontrar√© respuestas diciendome que use Heroku, Vercel o esas weas...¬øverdad? :("><meta property="og:type" content="article"><meta property="og:url" content="https://ventgrey.github.io/posts/desplegar-svelte-nginx/"><meta property="og:image" content="https://ventgrey.github.io/img/posts/sveltedesp/cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-25T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-25T00:00:00+00:00"><meta property="og:site_name" content="La Esquina Gris - Escribo un blog por terapia"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ventgrey.github.io/img/posts/sveltedesp/cover.png"><meta name=twitter:title content="Desplegar Svelte en NGINX y no morir en el intento"><meta name=twitter:description content="De nuevo, supongo que no encontrar√© respuestas diciendome que use Heroku, Vercel o esas weas...¬øverdad? :("><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ventgrey.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Desplegar Svelte en NGINX y no morir en el intento","item":"https://ventgrey.github.io/posts/desplegar-svelte-nginx/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Desplegar Svelte en NGINX y no morir en el intento","name":"Desplegar Svelte en NGINX y no morir en el intento","description":"De nuevo, supongo que no encontrar√© respuestas diciendome que use Heroku, Vercel o esas weas...¬øverdad? :(","keywords":["Tutoriales","Svelte","NGINX","Linux"],"articleBody":"No dejemos los pensamientos atr√°s. El porqu√© de este blog tard√≠o. Si, caemos en el viejo h√°bito de nuevo. Abandonar el blog o la enorme y extra√±a necesidad de reescribirlo sin raz√≥n alguna. Esta vez con un problema que ya ten√≠a tiempo de ser resuelto. Sin embargo, por motivos ajenos a esta publicaci√≥n, decid√≠ no postear la soluci√≥n hasta ahora.\nHace poco comenc√© a tomar el desarrollo web un poco m√°s en serio en mi vida y en mi carrera como sysadmin/‚Äú‚Äú‚ÄúDevOps‚Äù‚Äù\"/Web Dev. Debo confesar que no ha sido f√°cil, la mayor parte de las cosas utilizadas en la web moderna son horribles de pies a cabeza y, cuesta algo de trabajo / pensamiento profundo elegir una herramienta que no tenga cosas raras o que no resulte un dolor de cabeza eventualmente.\nEn mi b√∫squeda termin√© con el siguiente stack:\nTypeScript (Es menos feo que JS, sigue siendo feo, pero tolerable). Svelte (¬øConfigurar 70 bundlers, babel y dios sabr√° cuantas cosas m√°s? No gracias. Dame algo m√°s‚Ä¶cl√°sico). Bootstrap (No hay raz√≥n para no usarlo. Salvo que te dejes llevar por el hype de tailwind.). Rust + Rocket (El backend m√°s bonito de escribir y de usar) Debo de admitir que la combinaci√≥n de Svelte y TypeScript es casi perfecta. Todo es orientado a componentes, la reactividad es ‚Äúsencilla‚Äù. Creo que mis √∫nicos peros son que es imposible apagar por completo el tipo any y un par de cosas extra. Sin embargo esas son cosas menores, no tanto un problema real.\nSvelte y NGINX, el terror para los chicos ‚Äúserverless‚Äù. Al momento de terminar el sitio de UpVent lleg√≥ la necesidad de alojarlo en alguna parte. La verdad no poseo infraestructura propia por el momento, sin embargo Linode salv√≥ el d√≠a para mi :) ahora pod√≠a disfrutar de tener infraestructura como servicio por un proveedor decente que no involucre a ‚ÄúM.A.A.N.G‚Äù y sus productos que, fuera de razones laborales, no me gustar√≠a tocar ni con un palo de 10 metros.\nCon un servidor propiamente configurado, una API hecha en Rust y muchas ganas de triunfar me dispuse a buscar como desplegar mi aplicaci√≥n y oh no‚Ä¶no de nuevo.\nTengo que decir que me desespero f√°cilmente y, probablemente en internet exista otro tutorial que cubra este mismo proceso. Sin embargo yo no lo encontr√© y en su lugar me vi sumergido en un mar de v√≠deos, tutoriales y blogs que, m√°s all√° de desplegar en plataformas como heroku, netlify y otras cosas nuevas y extra√±as‚Ä¶bueno, termin√© sin encontrar lo que buscaba.\nAhora es momento de admitir que si, estuve a punto de rendirme por varios factores que debo aclarar en este blog. Principalmente porque manejar las rutas fue un dolor de cabeza. Ahora, manejarlas en un servidor web solo requiri√≥ una l√≠nea de NGINX para hacer la magia y una propia configuraci√≥n de Svelte.\nAntes que nada un par de consideraciones. Creo que este blog quede servir para casi cualquier router de svelte, exceptuando las rutas generadas por filesystem, no he tenido tiempo de experimentar con ellas y por lo tanto desconozco de su funcionamiento. En mi caso decid√≠ usar el router tinro, es un router peque√±o, declarativo y (esto es lo mejor) libre de dependencias.\nOtra de las cosas a tener en cuenta es que el sitio de UpVent es una SPA (Por sus siglas Single Page Application), por lo que el manejo de rutas es interno y por lo tanto, diferente, poco amigable con el SEO, etc.\nFinalmente mi SPA actual utiliza el sistema de construcci√≥n Vite. Por lo que, la configuraci√≥n de tinro podr√≠a ser diferente si tienes un proyecto de Svelte antiguo que usa rollup.\nConstruir proyecto En mi caso solo era necesaria la orden npm run build para que el proyecto se construya de forma satisfactoria.\nSubir el proyecto a tu servidor. En mi caso estoy usando un VPS con Red Hat y NGINX con una configuraci√≥n cl√°sica. De forma est√°ndar subiremos todo lo generado en el directorio dist/ al directorio de nuestro servidor:\nscp -r dist root@dominio.com:/var/www/html/pagina_web Ahora debemos corregir los permisos, como es una operaci√≥n r√°pida en nuestro servidor, no necesitamos iniciar sesi√≥n para hacer esto:\nssh root@dominio.com \"chown -R nginx:nginx /var/www/html\" Configurar el virtual host de NGINX Aqu√≠ viene la parte buena. Por defecto todas las aplicaciones de Svelte y Vite son SPA, lo que quiere decir que, sin un router interno de JS y una buena interpretaci√≥n de rutas por parte de NGINX, las cosas no funcionar√°n. Si intentas desplegar una SPA con rutas de tinro en NGINX de forma convencional solo te encontrar√°s con errores al momento de navegar en ella.\nAccede a tu servidor con SSH y comencemos a trabajar:\nssh root@dominio.com Si est√°s usando una configuraci√≥n similar a la m√≠a puedes comenzar a crear tu configuraci√≥n del sitio con el siguiente comando:\nvim /etc/nginx/sites-available/dominio.com.conf El trabajo ya est√° hecho, aqu√≠ abajo incluir√© la configuraci√≥n que us√© en mi NGINX para que Svelte funcione de forma correcta, abajo te explicar√© las opciones, sirve que, ambos aprendemos algo el d√≠a de hoy:\nserver { listen 80; listen [::]:80; root /var/www/html/pagina_web; index index.html; server_name domino.com; location / { try_files $uri $uri/ $uri.html /index.html =404; } } Ahora para que entiendas un poco las opciones:\nlisten 80;: Le dir√° a NGINX que escuche en el puerto 80, el puerto est√°ndar de HTTP. listen [::]:80;: Es lo mismo que el listen anterior, sin embargo este ser√° exclusivo para direcciones IPv6. root /var/www/html/pagina_web;: Esta directiva especifica el directorio ‚Äúra√≠z‚Äù en donde NGINX buscar√° un archivo. index index.html: Esta directiva le dir√° a NGINX que archivo index buscar, en este caso dejaremos el valor por defecto, ya que Svelte nos entrega un archivo index.html. server_name: El nombre del servidor desde el que NGINX procesar√° las peticiones. En este caso es el dominio que tengamos asignado a nuestra m√°quina / VPS. location / {...}: Esta parte es un poco dif√≠ƒáil de entender si no tenemos mucha experiencia con NGINX. B√°sicamente define donde NGINX debe buscar con la URL. En este caso es la URL base ‚Äú/‚Äù try_files $uri $uri/ /index.html =404;: Esta opci√≥n es la que hace la magia en nuestra aplicaci√≥n de Svelte. La directiva try_files busca los archivos y directorios que NGINX deber√≠a buscar dentro del directorio que definimos en root. El primer par√°metro especifica que intentar√° servir la uri sola, en este caso dominio.com, si dicho archivo no puede ser servido se intentar√° servir con una / extra, en este caso dominio.com/, finalmente la opci√≥n /index.html =404; act√∫a como red de seguridad, en caso de que no se pueda servir la uri/ se buscar√° por defecto en el archivo index.html, si no se encuentra nada, solamente se enviar√° un error 404. Cuando terminemos de configurar este archivo, guardaremos los cambios, salimos. Y procedemos a activarlo haciendo un enlace simb√≥lico:\nln -s /etc/nginx/sites-available/dominio.com.conf /etc/nginx/sites-enabled/dominio.com.conf Lleg√≥ el momento de probar si nuestra configuraci√≥n es correcta, podemos hacer esto con el comando:\nnginx -t Este comando nos informar√° si algo sali√≥ mal o si existe alg√∫n problema de configuraci√≥n en nuestros archivos de configuraci√≥n de NGINX. Es importante ejecutar este comando cada que hagamos cambios en un archivo de servidor. Esto para evitar downtime en caso de que NGINX se interrumpa por alg√∫n error en los archivos de configuraci√≥n.\nReiniciar NGINX de forma agraciada o a lo bestia. Si el comando anterior (nginx -t) nos reporta que todo est√° bien con nuestros archivos de configuraci√≥n podemos reiniciar el servidor de NGINX. Podemos intentar hacer un graceful restart y evitar el downtime, sin embargo, en caso de que nuestras configuraciones no surtan efecto o necesitemos una acualizaci√≥n no tendremos de otra m√°s que usar el modo bestia.\nLa primer forma de reiniciar NGINX de forma agraciada es con el comando:\nnginx -s reload Si esta opci√≥n no funciona para nosotros podemos optar por reiniciar ‚Äúa lo bestia‚Äù:\n# Con systemd systemctl restart nginx # Con OpenRC service nginx restart A√±adir un certificado SSL de Let‚Äôs Encrypt. Una vez tengamos nuestro archivo de nginx terminado podemos a√±adir un certificado SSL para que nuestro sitio sea confiable y nuestros usuarios puedan acceder de forma tranquila al mismo.\nLa instalaci√≥n de certbot ser√° diferente dependiendo de tu distribuci√≥n de Gnu/Linux, en mi caso con Red Hat solo tuve que instalar el paquete epel-release y ejecutar la orden dnf install certbot python3-certbot-nginx.\nSi nuestra configuraci√≥n de dominios es correcta, solo har√° falta pedirle a certbot un certificado para nuestro sitio con la siguiente orden:\ncertbot --nginx -d dominio.com Solo ser√° necesario seguir las instrucciones que aparezcan en consola.\nExtras Personalmente, no me gusta que se quede plano todo el server block de NGINX cuando podemos hacer algunas optimizaciones para mejorar el SEO y la velocidad de nuestro sitio. No explicar√© a detalle que hace cada uno de los bloques de directivas que escribir√© a continuaci√≥n. Entenderlos para despu√©s modificarlos quedar√° como tarea para ti. Espero que te sirvan :)\nCache de elementos est√°ticos comunes como im√°genes o v√≠deos. location ~* \\.(jpg|jpeg|png|gif|ico|css|js|svg|ttf|webp)$ { expires 365d; } Seguridad para evitar XSS y otros ataques comunes al lenguaje segur√≠simo que es JavaScript. add_header X-Frame-Options \"SAMEORIGIN\" always; add_header X-XSS-Protection \"1; mode=block\" always; add_header X-Content-Type-Options \"nosniff\" always; add_header Referrer-Policy \"no-referrer-when-downgrade\" always; add_header Content-Security-Policy \"default-src 'self'; script-src 'self'; img-src 'self'; style-src 'self' 'unsafe-inline'; font-src 'self'; frame-src 'self'; connect-src 'self'; object-src 'none';\"; Compresi√≥n gzip para mejorar los tiempos de carga a costo de CPU gzip on; gzip_vary on; gzip_proxied any; gzip_min_length 256; gzip_comp_level 9; gzip_http_version 1.1; gzip_disable \"MSIE [1-6]\\.\"; gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript application/javascript application/vnd.ms-fontobject application/x-font-ttf font/opentype image/svg+xml image/x-icon image/webp; gunzip on; Conclusi√≥n Desplegar Svelte en NGINX no es una tarea especialmente tit√°nica con un poco de investigaci√≥n por debajo. Sin embargo, debo de admitir que es un terrible dolor de cabeza tener que buscar entre cientos de art√≠culos de gente que solo sabe vivir del PaaS (este blog) sin encontrar un buen lugar para los ‚Äúvieja escuela‚Äù que a√∫n gustamos del self-hosting.\nSi te gust√≥ mi contenido por favor comp√°rtelo con tus amigos, de ser posible suscr√≠bete usando el bot√≥n de RSS en el fondo de la p√°gina o si te sientes con √°nimos puedes invitarme un caf√© picando el bot√≥n ‚ÄúTip Me‚Äù en la esquina inferior izquierda de tu pantalla :)\n¬°Nos leemos pronto!\n¬øTe gustan estos blogs? Ay√∫dame a seguir escribi√©ndolos de las siguientes formas:\nInv√≠tame un caf√© üçµ Reg√°lame un follow en GitHub ‚ù§ ","wordCount":"1733","inLanguage":"en","image":"https://ventgrey.github.io/img/posts/sveltedesp/cover.png","datePublished":"2022-08-25T00:00:00Z","dateModified":"2022-08-25T00:00:00Z","author":{"@type":"Person","name":"VentGrey"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ventgrey.github.io/posts/desplegar-svelte-nginx/"},"publisher":{"@type":"Organization","name":"La Esquina Gris","logo":{"@type":"ImageObject","url":"https://ventgrey.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ventgrey.github.io/ accesskey=h title="La Esquina Gris (Alt + H)"><img src=https://ventgrey.github.io/apple-touch-icon.png alt aria-label=logo height=35>La Esquina Gris</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ventgrey.github.io/categories/ title=Categorias><span>Categorias</span></a></li><li><a href=https://ventgrey.github.io/tags/ title=Etiquetas><span>Etiquetas</span></a></li><li><a href=https://upvent.codes title="¬øBuscas a UpVent?"><span>¬øBuscas a UpVent?</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ventgrey.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://ventgrey.github.io/posts/>Posts</a></div><h1 class=post-title>Desplegar Svelte en NGINX y no morir en el intento</h1><div class=post-description>De nuevo, supongo que no encontrar√© respuestas diciendome que use Heroku, Vercel o esas weas...¬øverdad? :(</div><div class=post-meta><span title='2022-08-25 00:00:00 +0000 UTC'>August 25, 2022</span>&nbsp;¬∑&nbsp;9 min&nbsp;¬∑&nbsp;1733 words&nbsp;¬∑&nbsp;VentGrey&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/desplegar-svelte-nginx.md rel="noopener noreferrer" target=_blank>Sugerir Cambios</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#antes-que-nada-un-par-de-consideraciones>Antes que nada un par de consideraciones.</a></li><li><a href=#construir-proyecto>Construir proyecto</a></li><li><a href=#subir-el-proyecto-a-tu-servidor>Subir el proyecto a tu servidor.</a></li><li><a href=#configurar-el-virtual-host-de-nginx>Configurar el virtual host de NGINX</a></li><li><a href=#reiniciar-nginx-de-forma-agraciada-o-a-lo-bestia>Reiniciar NGINX de forma agraciada o a lo bestia.</a></li><li><a href=#a√±adir-un-certificado-ssl-de-lets-encrypt>A√±adir un certificado SSL de Let&rsquo;s Encrypt.</a></li><li><a href=#extras>Extras</a><ul><li><a href=#cache-de-elementos-est√°ticos-comunes-como-im√°genes-o-v√≠deos>Cache de elementos est√°ticos comunes como im√°genes o v√≠deos.</a></li><li><a href=#seguridad-para-evitar-xss-y-otros-ataques-comunes-al-lenguaje-segur√≠simo-que-es-javascript>Seguridad para evitar XSS y otros ataques comunes al lenguaje segur√≠simo que es JavaScript.</a></li><li><a href=#compresi√≥n-gzip-para-mejorar-los-tiempos-de-carga-a-costo-de-cpu>Compresi√≥n gzip para mejorar los tiempos de carga a costo de CPU</a></li></ul></li><li><a href=#conclusi√≥n>Conclusi√≥n</a></li></ul></nav></div></details></div><div class=post-content><h1 id=no-dejemos-los-pensamientos-atr√°s-el-porqu√©-de-este-blog-tard√≠o>No dejemos los pensamientos atr√°s. El porqu√© de este blog tard√≠o.<a hidden class=anchor aria-hidden=true href=#no-dejemos-los-pensamientos-atr√°s-el-porqu√©-de-este-blog-tard√≠o>#</a></h1><p>Si, caemos en el viejo h√°bito de nuevo. Abandonar el blog o la enorme y extra√±a necesidad de reescribirlo sin raz√≥n alguna. Esta vez con un problema que ya ten√≠a tiempo de ser resuelto. Sin embargo, por motivos ajenos a esta publicaci√≥n, decid√≠ no postear la soluci√≥n hasta ahora.</p><p>Hace poco comenc√© a tomar el desarrollo web un poco m√°s en serio en mi vida y en mi carrera como sysadmin/&ldquo;&ldquo;&ldquo;DevOps&rdquo;&rdquo;"/Web Dev. Debo confesar que no ha sido f√°cil, la mayor parte de las cosas utilizadas en la web moderna son horribles de pies a cabeza y, cuesta algo de trabajo / pensamiento profundo elegir una herramienta que no tenga cosas raras o que no resulte un dolor de cabeza eventualmente.</p><p>En mi b√∫squeda termin√© con el siguiente stack:</p><ul><li>TypeScript (Es menos feo que JS, sigue siendo feo, pero tolerable).</li><li>Svelte (¬øConfigurar 70 bundlers, babel y dios sabr√° cuantas cosas m√°s? No gracias. Dame algo m√°s&mldr;cl√°sico).</li><li>Bootstrap (No hay raz√≥n para no usarlo. Salvo que te dejes llevar por el hype de tailwind.).</li><li>Rust + Rocket (El backend m√°s bonito de escribir y de usar)</li></ul><p>Debo de admitir que la combinaci√≥n de Svelte y TypeScript es casi perfecta. Todo es orientado a componentes, la reactividad es &ldquo;sencilla&rdquo;. Creo que mis √∫nicos peros son que es imposible apagar por completo el tipo <code>any</code> y un par de cosas extra. Sin embargo esas son cosas menores, no tanto un problema real.</p><h1 id=svelte-y-nginx-el-terror-para-los-chicos-serverless>Svelte y NGINX, el terror para los chicos &ldquo;serverless&rdquo;.<a hidden class=anchor aria-hidden=true href=#svelte-y-nginx-el-terror-para-los-chicos-serverless>#</a></h1><p>Al momento de terminar el <a href=https://upvent.codes>sitio de UpVent</a> lleg√≥ la necesidad de alojarlo en alguna parte. La verdad no poseo infraestructura propia por el momento, sin embargo <a href="https://www.linode.com/lp/refer/?r=2b48a57a9c813fa9972e3287171358c4f36746af">Linode</a> salv√≥ el d√≠a para mi :) ahora pod√≠a disfrutar de tener infraestructura como servicio por un proveedor decente que no involucre a <em>&ldquo;M.A.A.N.G&rdquo;</em> y sus productos que, fuera de razones laborales, no me gustar√≠a tocar ni con un palo de 10 metros.</p><p>Con un servidor propiamente configurado, una API hecha en Rust y muchas ganas de triunfar me dispuse a buscar como desplegar mi aplicaci√≥n y oh no&mldr;no de nuevo.</p><p>Tengo que decir que me desespero f√°cilmente y, probablemente en internet exista otro tutorial que cubra este mismo proceso. Sin embargo yo no lo encontr√© y en su lugar me vi sumergido en un mar de v√≠deos, tutoriales y blogs que, m√°s all√° de desplegar en plataformas como heroku, netlify y otras cosas nuevas y extra√±as&mldr;bueno, termin√© sin encontrar lo que buscaba.</p><p>Ahora es momento de admitir que si, estuve a punto de rendirme por varios factores que debo aclarar en este blog. Principalmente porque manejar las rutas fue un dolor de cabeza. Ahora, manejarlas en un servidor web solo requiri√≥ una l√≠nea de NGINX para hacer la magia y una propia configuraci√≥n de Svelte.</p><h2 id=antes-que-nada-un-par-de-consideraciones>Antes que nada un par de consideraciones.<a hidden class=anchor aria-hidden=true href=#antes-que-nada-un-par-de-consideraciones>#</a></h2><p>Creo que este blog quede servir para casi cualquier router de svelte, exceptuando las rutas generadas por <em>filesystem</em>, no he tenido tiempo de experimentar con ellas y por lo tanto desconozco de su funcionamiento. En mi caso decid√≠ usar el router <a href=https://github.com/AlexxNB/tinro>tinro</a>, es un router peque√±o, declarativo y (esto es lo mejor) libre de dependencias.</p><p>Otra de las cosas a tener en cuenta es que el sitio de UpVent es una SPA (Por sus siglas <em>Single Page Application</em>), por lo que el manejo de rutas es interno y por lo tanto, diferente, poco amigable con el SEO, etc.</p><p>Finalmente mi SPA actual utiliza el sistema de construcci√≥n <a href=https://vitejs.dev/>Vite</a>. Por lo que, la configuraci√≥n de tinro podr√≠a ser diferente si tienes un proyecto de Svelte antiguo que usa rollup.</p><h2 id=construir-proyecto>Construir proyecto<a hidden class=anchor aria-hidden=true href=#construir-proyecto>#</a></h2><p>En mi caso solo era necesaria la orden <code>npm run build</code> para que el proyecto se construya de forma satisfactoria.</p><h2 id=subir-el-proyecto-a-tu-servidor>Subir el proyecto a tu servidor.<a hidden class=anchor aria-hidden=true href=#subir-el-proyecto-a-tu-servidor>#</a></h2><p>En mi caso estoy usando un VPS con Red Hat y NGINX con una configuraci√≥n cl√°sica. De forma est√°ndar subiremos todo lo generado en el directorio <code>dist/</code> al directorio de nuestro servidor:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>scp -r dist root@dominio.com:/var/www/html/pagina_web
</span></span></code></pre></div><p>Ahora debemos corregir los permisos, como es una operaci√≥n r√°pida en nuestro servidor, no necesitamos iniciar sesi√≥n para hacer esto:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh root@dominio.com <span class=s2>&#34;chown -R nginx:nginx /var/www/html&#34;</span>
</span></span></code></pre></div><h2 id=configurar-el-virtual-host-de-nginx>Configurar el virtual host de NGINX<a hidden class=anchor aria-hidden=true href=#configurar-el-virtual-host-de-nginx>#</a></h2><p>Aqu√≠ viene la parte buena. Por defecto todas las aplicaciones de Svelte y Vite son <em>SPA</em>, lo que quiere decir que, sin un router interno de JS y una buena interpretaci√≥n de rutas por parte de NGINX, las cosas no funcionar√°n. Si intentas desplegar una <em>SPA</em> con rutas de tinro en NGINX de forma convencional solo te encontrar√°s con errores al momento de navegar en ella.</p><p>Accede a tu servidor con SSH y comencemos a trabajar:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh root@dominio.com
</span></span></code></pre></div><p>Si est√°s usando una configuraci√≥n similar a la m√≠a puedes comenzar a crear tu configuraci√≥n del sitio con el siguiente comando:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim /etc/nginx/sites-available/dominio.com.conf
</span></span></code></pre></div><p>El trabajo ya est√° hecho, aqu√≠ abajo incluir√© la configuraci√≥n que us√© en mi NGINX para que Svelte funcione de forma correcta, abajo te explicar√© las opciones, sirve que, ambos aprendemos algo el d√≠a de hoy:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>listen</span> <span class=s>[::]:80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>root</span> <span class=s>/var/www/html/pagina_web</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>index</span> <span class=s>index.html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>server_name</span> <span class=s>domino.com</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>try_files</span> <span class=nv>$uri</span> <span class=nv>$uri/</span> <span class=nv>$uri.html</span> <span class=s>/index.html</span> <span class=p>=</span><span class=mi>404</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Ahora para que entiendas un poco las opciones:</p><ul><li><code>listen 80;</code>: Le dir√° a NGINX que escuche en el puerto <code>80</code>, el puerto est√°ndar de HTTP.</li><li><code>listen [::]:80;</code>: Es lo mismo que el listen anterior, sin embargo este ser√° exclusivo para direcciones IPv6.</li><li><code>root /var/www/html/pagina_web;</code>: Esta directiva especifica el directorio &ldquo;ra√≠z&rdquo; en donde NGINX buscar√° un archivo.</li><li><code>index index.html</code>: Esta directiva le dir√° a NGINX que archivo index buscar, en este caso dejaremos el valor por defecto, ya que Svelte nos entrega un archivo <code>index.html</code>.</li><li><code>server_name</code>: El nombre del servidor desde el que NGINX procesar√° las peticiones. En este caso es el dominio que tengamos asignado a nuestra m√°quina / VPS.</li><li><code>location / {...}</code>: Esta parte es un poco dif√≠ƒáil de entender si no tenemos mucha experiencia con NGINX. B√°sicamente define donde NGINX debe buscar con la URL. En este caso es la URL base &ldquo;/&rdquo;</li><li><code>try_files $uri $uri/ /index.html =404;</code>: Esta opci√≥n es la que hace la magia en nuestra aplicaci√≥n de Svelte. La directiva <code>try_files</code> busca los archivos y directorios que NGINX deber√≠a buscar dentro del directorio que definimos en <code>root</code>. El primer par√°metro especifica que intentar√° servir la <code>uri</code> sola, en este caso <code>dominio.com</code>, si dicho archivo no puede ser servido se intentar√° servir con una <code>/</code> extra, en este caso <code>dominio.com/</code>, finalmente la opci√≥n <code>/index.html =404;</code> act√∫a como red de seguridad, en caso de que no se pueda servir la <code>uri/</code> se buscar√° por defecto en el archivo <code>index.html</code>, si no se encuentra nada, solamente se enviar√° un error 404.</li></ul><p>Cuando terminemos de configurar este archivo, guardaremos los cambios, salimos. Y procedemos a activarlo haciendo un enlace simb√≥lico:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ln -s /etc/nginx/sites-available/dominio.com.conf /etc/nginx/sites-enabled/dominio.com.conf
</span></span></code></pre></div><p>Lleg√≥ el momento de probar si nuestra configuraci√≥n es correcta, podemos hacer esto con el comando:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nginx -t
</span></span></code></pre></div><p>Este comando nos informar√° si algo sali√≥ mal o si existe alg√∫n problema de configuraci√≥n en nuestros archivos de configuraci√≥n de NGINX. Es importante ejecutar este comando cada que hagamos cambios en un archivo de servidor. Esto para evitar downtime en caso de que NGINX se interrumpa por alg√∫n error en los archivos de configuraci√≥n.</p><h2 id=reiniciar-nginx-de-forma-agraciada-o-a-lo-bestia>Reiniciar NGINX de forma agraciada o a lo bestia.<a hidden class=anchor aria-hidden=true href=#reiniciar-nginx-de-forma-agraciada-o-a-lo-bestia>#</a></h2><p>Si el comando anterior (<code>nginx -t</code>) nos reporta que todo est√° bien con nuestros archivos de configuraci√≥n podemos reiniciar el servidor de NGINX. Podemos intentar hacer un <em>graceful restart</em> y evitar el downtime, sin embargo, en caso de que nuestras configuraciones no surtan efecto o necesitemos una acualizaci√≥n no tendremos de otra m√°s que usar el modo bestia.</p><p>La primer forma de reiniciar NGINX de forma agraciada es con el comando:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nginx -s reload
</span></span></code></pre></div><p>Si esta opci√≥n no funciona para nosotros podemos optar por reiniciar &ldquo;a lo bestia&rdquo;:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Con systemd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>systemctl restart nginx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Con OpenRC</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>service nginx restart
</span></span></code></pre></div><h2 id=a√±adir-un-certificado-ssl-de-lets-encrypt>A√±adir un certificado SSL de Let&rsquo;s Encrypt.<a hidden class=anchor aria-hidden=true href=#a√±adir-un-certificado-ssl-de-lets-encrypt>#</a></h2><p>Una vez tengamos nuestro archivo de nginx terminado podemos a√±adir un certificado SSL para que nuestro sitio sea confiable y nuestros usuarios puedan acceder de forma tranquila al mismo.</p><p>La instalaci√≥n de <code>certbot</code> ser√° diferente dependiendo de tu distribuci√≥n de Gnu/Linux, en mi caso con Red Hat solo tuve que instalar el paquete <code>epel-release</code> y ejecutar la orden <code>dnf install certbot python3-certbot-nginx</code>.</p><p>Si nuestra configuraci√≥n de dominios es correcta, solo har√° falta pedirle a certbot un certificado para nuestro sitio con la siguiente orden:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>certbot --nginx -d dominio.com
</span></span></code></pre></div><p>Solo ser√° necesario seguir las instrucciones que aparezcan en consola.</p><h2 id=extras>Extras<a hidden class=anchor aria-hidden=true href=#extras>#</a></h2><p>Personalmente, no me gusta que se quede plano todo el server block de NGINX cuando podemos hacer algunas optimizaciones para mejorar el SEO y la velocidad de nuestro sitio. No explicar√© a detalle que hace cada uno de los bloques de directivas que escribir√© a continuaci√≥n. Entenderlos para despu√©s modificarlos quedar√° como tarea para ti. Espero que te sirvan :)</p><h3 id=cache-de-elementos-est√°ticos-comunes-como-im√°genes-o-v√≠deos>Cache de elementos est√°ticos comunes como im√°genes o v√≠deos.<a hidden class=anchor aria-hidden=true href=#cache-de-elementos-est√°ticos-comunes-como-im√°genes-o-v√≠deos>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>location</span> <span class=p>~</span><span class=sr>*</span> <span class=s>\.(jpg|jpeg|png|gif|ico|css|js|svg|ttf|webp)</span>$ <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>expires</span> <span class=s>365d</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=seguridad-para-evitar-xss-y-otros-ataques-comunes-al-lenguaje-segur√≠simo-que-es-javascript>Seguridad para evitar XSS y otros ataques comunes al lenguaje segur√≠simo que es JavaScript.<a hidden class=anchor aria-hidden=true href=#seguridad-para-evitar-xss-y-otros-ataques-comunes-al-lenguaje-segur√≠simo-que-es-javascript>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>add_header</span> <span class=s>X-Frame-Options</span> <span class=s>&#34;SAMEORIGIN&#34;</span> <span class=s>always</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>add_header</span> <span class=s>X-XSS-Protection</span> <span class=s>&#34;1</span><span class=p>;</span> <span class=k>mode=block&#34;</span> <span class=s>always</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>add_header</span> <span class=s>X-Content-Type-Options</span> <span class=s>&#34;nosniff&#34;</span> <span class=s>always</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>add_header</span> <span class=s>Referrer-Policy</span> <span class=s>&#34;no-referrer-when-downgrade&#34;</span> <span class=s>always</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>add_header</span> <span class=s>Content-Security-Policy</span> <span class=s>&#34;default-src</span> <span class=s>&#39;self&#39;</span><span class=p>;</span> <span class=k>script-src</span> <span class=s>&#39;self&#39;</span><span class=p>;</span> <span class=k>img-src</span> <span class=s>&#39;self&#39;</span><span class=p>;</span> <span class=k>style-src</span> <span class=s>&#39;self&#39;</span> <span class=s>&#39;unsafe-inline&#39;</span><span class=p>;</span> <span class=k>font-src</span> <span class=s>&#39;self&#39;</span><span class=p>;</span> <span class=k>frame-src</span> <span class=s>&#39;self&#39;</span><span class=p>;</span> <span class=k>connect-src</span> <span class=s>&#39;self&#39;</span><span class=p>;</span> <span class=k>object-src</span> <span class=s>&#39;none&#39;</span><span class=p>;</span><span class=k>&#34;</span><span class=p>;</span>
</span></span></code></pre></div><h3 id=compresi√≥n-gzip-para-mejorar-los-tiempos-de-carga-a-costo-de-cpu>Compresi√≥n gzip para mejorar los tiempos de carga a costo de CPU<a hidden class=anchor aria-hidden=true href=#compresi√≥n-gzip-para-mejorar-los-tiempos-de-carga-a-costo-de-cpu>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>gzip</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>gzip_vary</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>gzip_proxied</span> <span class=s>any</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>gzip_min_length</span> <span class=mi>256</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>gzip_comp_level</span> <span class=mi>9</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>gzip_http_version</span> <span class=mi>1</span><span class=s>.1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>gzip_disable</span> <span class=s>&#34;MSIE</span> <span class=s>[1-6]\.&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>gzip_types</span> <span class=s>text/plain</span> <span class=s>text/css</span> <span class=s>application/json</span> <span class=s>application/x-javascript</span> <span class=s>text/xml</span> <span class=s>application/xml</span> <span class=s>application/xml+rss</span> <span class=s>text/javascript</span> <span class=s>application/javascript</span> <span class=s>application/vnd.ms-fontobject</span> <span class=s>application/x-font-ttf</span> <span class=s>font/opentype</span> <span class=s>image/svg+xml</span> <span class=s>image/x-icon</span> <span class=s>image/webp</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>gunzip</span> <span class=no>on</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=conclusi√≥n>Conclusi√≥n<a hidden class=anchor aria-hidden=true href=#conclusi√≥n>#</a></h2><p>Desplegar Svelte en NGINX no es una tarea especialmente tit√°nica con un poco de investigaci√≥n por debajo. Sin embargo, debo de admitir que es un terrible dolor de cabeza tener que buscar entre cientos de art√≠culos de gente que solo sabe vivir del PaaS (este blog) sin encontrar un buen lugar para los &ldquo;vieja escuela&rdquo; que a√∫n gustamos del self-hosting.</p><p>Si te gust√≥ mi contenido por favor comp√°rtelo con tus amigos, de ser posible suscr√≠bete usando el bot√≥n de RSS en el fondo de la p√°gina o si te sientes con √°nimos puedes invitarme un caf√© picando el bot√≥n &ldquo;Tip Me&rdquo; en la esquina inferior izquierda de tu pantalla :)</p><p>¬°Nos leemos pronto!</p><hr><p>¬øTe gustan estos blogs? Ay√∫dame a seguir escribi√©ndolos de las siguientes formas:</p><ul><li><a href=https://ko-fi.com/ventgrey>Inv√≠tame un caf√© üçµ</a></li><li><a href=https://github.com/VentGrey>Reg√°lame un follow en GitHub ‚ù§</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://ventgrey.github.io/tags/tutoriales/>Tutoriales</a></li><li><a href=https://ventgrey.github.io/tags/svelte/>Svelte</a></li><li><a href=https://ventgrey.github.io/tags/nginx/>NGINX</a></li><li><a href=https://ventgrey.github.io/tags/linux/>Linux</a></li></ul><nav class=paginav><a class=prev href=https://ventgrey.github.io/posts/proteger-nginx/><span class=title>¬´ Prev</span><br><span>Proteger rutas web con NGINX</span></a>
<a class=next href=https://ventgrey.github.io/posts/fuentes-personalizadas-svelte/><span class=title>Next ¬ª</span><br><span>Como a√±adir fuentes personalizadas a un proyecto de Svelte (Sin plugins de Vite)</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Desplegar Svelte en NGINX y no morir en el intento on twitter" href="https://twitter.com/intent/tweet/?text=Desplegar%20Svelte%20en%20NGINX%20y%20no%20morir%20en%20el%20intento&url=https%3a%2f%2fventgrey.github.io%2fposts%2fdesplegar-svelte-nginx%2f&hashtags=Tutoriales%2cSvelte%2cNGINX%2cLinux"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Desplegar Svelte en NGINX y no morir en el intento on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fventgrey.github.io%2fposts%2fdesplegar-svelte-nginx%2f&title=Desplegar%20Svelte%20en%20NGINX%20y%20no%20morir%20en%20el%20intento&summary=Desplegar%20Svelte%20en%20NGINX%20y%20no%20morir%20en%20el%20intento&source=https%3a%2f%2fventgrey.github.io%2fposts%2fdesplegar-svelte-nginx%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Desplegar Svelte en NGINX y no morir en el intento on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fventgrey.github.io%2fposts%2fdesplegar-svelte-nginx%2f&title=Desplegar%20Svelte%20en%20NGINX%20y%20no%20morir%20en%20el%20intento"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Desplegar Svelte en NGINX y no morir en el intento on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fventgrey.github.io%2fposts%2fdesplegar-svelte-nginx%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Desplegar Svelte en NGINX y no morir en el intento on whatsapp" href="https://api.whatsapp.com/send?text=Desplegar%20Svelte%20en%20NGINX%20y%20no%20morir%20en%20el%20intento%20-%20https%3a%2f%2fventgrey.github.io%2fposts%2fdesplegar-svelte-nginx%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Desplegar Svelte en NGINX y no morir en el intento on telegram" href="https://telegram.me/share/url?text=Desplegar%20Svelte%20en%20NGINX%20y%20no%20morir%20en%20el%20intento&url=https%3a%2f%2fventgrey.github.io%2fposts%2fdesplegar-svelte-nginx%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://ventgrey.github.io/>La Esquina Gris</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>